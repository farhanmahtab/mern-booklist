{"ast":null,"code":"import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nexport const fetchBooks = createAsyncThunk(\"books/fetchBooks\", async () => {\n  const res = await axios.get(\"http://localhost:5001/api/books\");\n  //console.log(res.data)\n  return res.data;\n});\nexport const addBook = createAsyncThunk(\"items/addBook\", async book => {\n  const {\n    title,\n    author,\n    price\n  } = book;\n  const res = await axios.post(\"http://localhost:5001/api/books\", {\n    name: title,\n    author,\n    price\n  }, {\n    headers: {\n      Authorization: localStorage.getItem(\"token\")\n    }\n  });\n  return res.data;\n});\nexport const deleteBook = createAsyncThunk(\"books/deleteBook\", async book_id => {\n  //console.log(book_id);\n  const URL = `http://localhost:5001/api/books/${book_id}`;\n  console.log(URL);\n  const res = await axios.delete(URL, {\n    headers: {\n      Authorization: localStorage.getItem(\"token\")\n    }\n  });\n  console.log(res);\n  return res.data;\n});\nexport const bookSlice = createSlice({\n  name: \"books\",\n  initialState: {\n    isLoading: false,\n    books: [],\n    error: null\n  },\n  reducers: {\n    showBooks: state => state,\n    updateBook: (state, action) => {\n      const {\n        id,\n        name,\n        author,\n        price\n      } = action.payload;\n      const isBookExist = state.books.filter(book => book.id === id);\n      if (isBookExist) {\n        isBookExist[0].name = name;\n        isBookExist[0].author = author;\n        isBookExist[0].price = price;\n      }\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(fetchBooks.pending, state => {\n      state.isLoading = true;\n    });\n    builder.addCase(fetchBooks.fulfilled, (state, action) => {\n      state.isLoading = false;\n      state.books = action.payload;\n      state.error = null;\n    });\n    builder.addCase(fetchBooks.rejected, (state, action) => {\n      state.isLoading = false;\n      state.books = [...state.books];\n      state.error = action.payload;\n    });\n    builder.addCase(addBook.fulfilled, (state, action) => {\n      state.isLoading = false;\n      if (action.payload) state.books.unshift(action.payload);\n    });\n    builder.addCase(deleteBook.fulfilled, (state, action) => {\n      state.isLoading = false;\n      if (action.payload.message === \"book Deleted\") state.books = state.books.filter(item => item._id !== action.payload.id);\n    });\n  }\n});\nexport default bookSlice.reducer;\nexport const {\n  showBooks,\n  updateBook,\n  booksLoading\n} = bookSlice.actions;","map":{"version":3,"names":["createAsyncThunk","createSlice","axios","fetchBooks","res","get","data","addBook","book","title","author","price","post","name","headers","Authorization","localStorage","getItem","deleteBook","book_id","URL","console","log","delete","bookSlice","initialState","isLoading","books","error","reducers","showBooks","state","updateBook","action","id","payload","isBookExist","filter","extraReducers","builder","addCase","pending","fulfilled","rejected","unshift","message","item","_id","reducer","booksLoading","actions"],"sources":["/home/sbh/office_Docs/redux_task/client/src/features/books/BookSlice.js"],"sourcesContent":["import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\n\nexport const fetchBooks = createAsyncThunk(\"books/fetchBooks\", async () => {\n  const res = await axios.get(\"http://localhost:5001/api/books\");\n  //console.log(res.data)\n  return res.data;\n});\nexport const addBook = createAsyncThunk(\"items/addBook\", async (book) => {\n  const { title, author, price } = book;\n  const res = await axios.post(\n    \"http://localhost:5001/api/books\",\n    {\n      name: title,\n      author,\n      price,\n    },\n    {\n      headers: {\n        Authorization: localStorage.getItem(\"token\"),\n      },\n    }\n  );\n  return res.data;\n});\nexport const deleteBook = createAsyncThunk(\n  \"books/deleteBook\",\n  async (book_id) => {\n    //console.log(book_id);\n    const URL = `http://localhost:5001/api/books/${book_id}`;\n    console.log(URL);\n    const res = await axios.delete(URL, {\n      headers: {\n        Authorization: localStorage.getItem(\"token\"),\n      },\n    });\n    console.log(res);\n    return res.data;\n  }\n);\n\nexport const bookSlice = createSlice({\n  name: \"books\",\n  initialState: {\n    isLoading: false,\n    books: [],\n    error: null,\n  },\n  reducers: {\n    showBooks: (state) => state,\n    updateBook: (state, action) => {\n      const { id, name, author, price } = action.payload;\n      const isBookExist = state.books.filter((book) => book.id === id);\n      if (isBookExist) {\n        isBookExist[0].name = name;\n        isBookExist[0].author = author;\n        isBookExist[0].price = price;\n      }\n    },\n  },\n  extraReducers: (builder) => {\n    builder.addCase(fetchBooks.pending, (state) => {\n      state.isLoading = true;\n    });\n    builder.addCase(fetchBooks.fulfilled, (state, action) => {\n      state.isLoading = false;\n      state.books = action.payload;\n      state.error = null;\n    });\n    builder.addCase(fetchBooks.rejected, (state, action) => {\n      state.isLoading = false;\n      state.books = [...state.books];\n      state.error = action.payload;\n    });\n    builder.addCase(addBook.fulfilled, (state, action) => {\n      state.isLoading = false;\n      if (action.payload) state.books.unshift(action.payload);\n    });\n    builder.addCase(deleteBook.fulfilled, (state, action) => {\n      state.isLoading = false;\n      if (action.payload.message === \"book Deleted\")\n        state.books = state.books.filter(\n          (item) => item._id !== action.payload.id\n        );\n    });\n  },\n});\n\nexport default bookSlice.reducer;\nexport const { showBooks, updateBook, booksLoading } = bookSlice.actions;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}